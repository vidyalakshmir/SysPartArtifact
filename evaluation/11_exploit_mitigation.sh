#!/bin/bash
comm -23 <(sort unique_syscallnames_x64.txt) <(sort ../outputs/bind/syscall_results/mainloop_sysnames.txt) > exploit_mitigation/sp_filtered_syscalls/bind.txt
comm -23 <(sort unique_syscallnames_x64.txt) <(sort ../outputs/httpd/syscall_results/mainloop_sysnames.txt) > exploit_mitigation/sp_filtered_syscalls/httpd.txt
grep 'SYSCALLS' ../outputs/lighttpd/serving_syscalls.out | awk {'print $2'} | sed 's/\[//' | sed 's/\]//' | sed 's/,/\n/g' > ../outputs/lighttpd/syscall_results/serving_sysnames.txt
comm -23 <(sort unique_syscallnames_x64.txt) <(sort ../outputs/lighttpd/syscall_results/serving_sysnames.txt) > exploit_mitigation/sp_filtered_syscalls/lighttpd.txt
comm -23 <(sort unique_syscallnames_x64.txt) <(sort ../outputs/memcached/syscall_results/mainloop_sysnames.txt) > exploit_mitigation/sp_filtered_syscalls/memcached.txt
comm -23 <(sort unique_syscallnames_x64.txt) <(sort ../outputs/nginx/syscall_results/mainloop_sysnames.txt) > exploit_mitigation/sp_filtered_syscalls/nginx.txt
comm -23 <(sort unique_syscallnames_x64.txt) <(sort ../outputs/redis/syscall_results/mainloop_sysnames.txt) > exploit_mitigation/sp_filtered_syscalls/redis.txt
cd exploit_mitigation
./commands_sp.sh
./commands_sf.sh
./commands_tsp.sh
./commands_tsp_fixed.sh


